<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>API Tester</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    label { display: block; margin-top: 10px; }
    textarea { width: 100%; height: 100px; }
    pre { background: #f4f4f4; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <h1>Тест Client API BattleStats</h1>
  
  <label>
    Метод:
    <select id="method">
      <option value="GET">GET</option>
      <option value="POST">POST</option>
      <option value="DELETE">DELETE</option>
    </select>
  </label>

  <label>
    Endpoint:
    <select id="endpoint">
      <option value="stats">GET /stats</option>
      <option value="other-players">GET /other-players</option>
      <option value="update-stats">POST /update-stats</option>
      <option value="import">POST /import</option>
      <option value="clear">DELETE /clear</option>
      <option value="battle/123">DELETE /battle/:battleId</option>
      <option value="health">GET /health</option>
      <option value="version">GET /version</option>
    </select>
  </label>

  <label>
    X-API-Key:
    <input type="text" id="apiKey" value="test" />
  </label>

  <label>
    X-Player-ID (для деяких endpoints):
    <input type="text" id="playerId" placeholder="player123" />
  </label>
  
  <label>
    Тіло запиту (JSON):
    <textarea id="body">{}</textarea>
  </label>
  
  <button id="send">Надіслати</button>
  
  <h2>Результат:</h2>
  <pre id="output"></pre>
  
  <script>
    const BASE_URL = "https://node-websocket-758468a49fee.herokuapp.com";
    
    document.getElementById("send").addEventListener("click", async () => {
      const method = document.getElementById("method").value;
      const endpoint = document.getElementById("endpoint").value;
      const apiKey = document.getElementById("apiKey").value;
      const playerId = document.getElementById("playerId").value;
      const body = document.getElementById("body").value;
      const output = document.getElementById("output");
      
      output.textContent = "Виконується запит...";
      
      try {
        const headers = {
          "Content-Type": "application/json",
          "X-API-Key": apiKey
        };
        
        if (playerId) {
          headers["X-Player-ID"] = playerId;
        }
        
        const options = { method, headers };
        
        if (method !== "GET" && body.trim() !== "") {
          options.body = body;
        }
        
        const res = await fetch(`${BASE_URL}/api/battle-stats/${endpoint}`, options);
        const responseText = await res.text();
        
        try {
          const jsonResponse = JSON.parse(responseText);
          output.textContent = JSON.stringify(jsonResponse, null, 2);
        } catch {
          output.textContent = responseText;
        }
        
      } catch (err) {
        output.textContent = "Помилка: " + err.message;
      }
    });
  </script>
</body>
</html>


